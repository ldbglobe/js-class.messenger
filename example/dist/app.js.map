{"version":3,"file":"app.js","mappings":"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","sources":["webpack:///webpack/bootstrap","webpack:///webpack/runtime/make namespace object","webpack:///../node_modules/js-class.event-dispatcher/src/index.js","webpack:///../src/index.js","webpack:///./src/app.js"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","export default class EventDispatcher {\r\n\tconstructor(eventSource) {\r\n\t\tthis.eventSource = eventSource;\r\n\t\tthis.events = new Set();\r\n\t}\r\n\r\n\t// registration methods\r\n\tregisterEvent(eventName, callback) {\r\n\t\tif(typeof callback === \"function\")\r\n\t\t{\r\n\t\t\tif(!this.events[eventName])\r\n\t\t\t\tthis.events[eventName] = new Set();\r\n\r\n\t\t\tthis.events[eventName].add(callback)\r\n\t\t}\r\n\t}\r\n\tunregisterEvent(eventName, callback) {\r\n\t\tif(this.events[eventName])\r\n\t\t\tthis.events[eventName].delete(callback)\r\n\t}\r\n\r\n\t// trigger event\r\n\tfireEvent(eventName, data) {\r\n\t\tif(this.events[eventName])\r\n\t\t{\r\n\t\t\tthis.events[eventName].forEach(function(callback, index) {\r\n\t\t\t\tcallback(data,{\r\n\t\t\t\t\teventSource:this.eventSource,\r\n\t\t\t\t\teventName:eventName,\r\n\t\t\t\t\tdata:data\r\n\t\t\t\t});\r\n\t\t\t}.bind(this))\r\n\t\t}\r\n\t}\r\n}","import EventDispatcher from \"js-class.event-dispatcher\";\r\n\r\nwindow.MessengerWelcome_260b9b39071b9918 = function(w=null)\r\n{\r\n\tif(w)\r\n\t\tMessenger.___.recipients.add(w)\r\n\telse\r\n\t{\r\n\t\tif(window.opener && typeof window.opener.MessengerWelcome_260b9b39071b9918 === \"function\")\r\n\t\t\twindow.opener.MessengerWelcome_260b9b39071b9918(window);\r\n\t}\r\n}\r\n\r\nexport default class Messenger {\r\n\r\n\tstatic ___ = {\r\n\t\trecipients: new Set(),\r\n\t}\r\n\r\n\tconstructor(param) {\r\n\t\tparam = typeof param ===\"string\" ? {channel:param}: param || {};\r\n\t\tthis.id = (()=>('MSG_'+[1e16]).replace(/[018]/g,a=>(a^Math.random()*16>>a/4).toString(16)))();\r\n\t\tthis.channels = new Set();\r\n\t\tthis.recipients = new Set();\r\n\r\n\t\tif(param.channel)\r\n\t\t\tthis.subscribe(param.channel);\r\n\r\n\t\tif(window.opener)\r\n\t\t\tMessenger.___.recipients.add(window.opener);\r\n\r\n\t\tthis.events = new EventDispatcher(this);\r\n\t\twindow.addEventListener('message', this.__handleMessage.bind(this))\r\n\r\n\t\twindow.MessengerWelcome_260b9b39071b9918();\r\n\t}\r\n\r\n\tsubscribe(channel) {\r\n\t\tif(channel && typeof channel === \"string\")\r\n\t\t{\r\n\t\t\tconsole.info(`Messenger ${this.id} connected to ${channel}`);\r\n\t\t\tthis.channels.add(channel)\r\n\t\t}\r\n\t}\r\n\tunsubscribe(channel) {\r\n\t\tthis.channels.delete(channel)\r\n\t}\r\n\r\n\tonMessage(callback,channels=null) {\r\n\t\tchannels = typeof channels === \"string\" ? [channels] : channels;\r\n\t\tchannels = channels && channels.length ? channels : [];\r\n\t\tthis.events.registerEvent('message',function(callback, channels, data, eventSource) {\r\n\t\t\tif(channels.length===0 || channels.includes(data.channel))\r\n\t\t\t\tcallback(data.message,data.channel)\r\n\t\t}.bind(this, callback, channels))\r\n\t}\r\n\r\n\t__handleMessage(e) {\r\n\t\tlet data = typeof e.data === \"string\" ? JSON.parse(e.data) : (e.data || {});\r\n\t\tif(data.format === 'messenger')\r\n\t\t{\r\n\t\t\t// relay all channel on other windows\r\n\t\t\tthis.send(data.message,data.channel,e.source,true)\r\n\r\n\t\t\t// fire local event if channel is subscribed\r\n\t\t\tif(this.channels.has(data.channel))\r\n\t\t\t{\r\n\t\t\t\tthis.events.fireEvent('message',data);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tsend(message,destinationChannel=null,emiter=null,relay=false) {\r\n\t\tif(destinationChannel && !this.channels.has(destinationChannel))\r\n\t\t{\r\n\t\t\tif(!relay)\r\n\t\t\t\tthrow `Messenger.send not subscribed to ${destinationChannel}`\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\tvar channels = destinationChannel ? new Set([destinationChannel]) : this.channels;\r\n\t\t\tif(channels.size>0)\r\n\t\t\t{\r\n\t\t\t\tchannels.forEach(function(message,destinationChannel,emiter,channel) {\r\n\t\t\t\t\tif(destinationChannel===null || destinationChannel === channel)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.__sendToWindows(JSON.stringify({\r\n\t\t\t\t\t\t\tformat:'messenger',\r\n\t\t\t\t\t\t\tversion:1,\r\n\t\t\t\t\t\t\temiter:this.id,\r\n\t\t\t\t\t\t\tchannel:channel,\r\n\t\t\t\t\t\t\tmessage:message,\r\n\t\t\t\t\t\t}),emiter);\r\n\t\t\t\t\t}\r\n\t\t\t\t}.bind(this,message,destinationChannel,emiter));\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\tthrow `Messenger.send no destination channels available`\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t__sendToWindows(payload,emiter) {\r\n\t\tMessenger.___.recipients.forEach(function(emiter,recipient){\r\n\t\t\tif(recipient && typeof recipient.postMessage === \"function\")\r\n\t\t\t{\r\n\t\t\t\tif(emiter!==recipient && !recipient.closed)\r\n\t\t\t\t\trecipient.postMessage(payload,\"*\");\r\n\t\t\t}\r\n\t\t}.bind(this,emiter))\r\n\t}\r\n}","import Messenger from \"../../src/index.js\"\r\n\r\nwindow.Messenger = Messenger"],"names":["__webpack_require__","exports","Symbol","toStringTag","Object","defineProperty","value","EventDispatcher","constructor","eventSource","this","events","Set","registerEvent","eventName","callback","add","unregisterEvent","delete","fireEvent","data","forEach","index","bind","window","MessengerWelcome_260b9b39071b9918","w","Messenger","___","recipients","opener","param","channel","id","replace","a","Math","random","toString","channels","subscribe","addEventListener","__handleMessage","console","info","length","includes","message","e","JSON","parse","format","send","source","has","destinationChannel","emiter","relay","size","__sendToWindows","stringify","version","payload","recipient","postMessage","closed"],"sourceRoot":""}